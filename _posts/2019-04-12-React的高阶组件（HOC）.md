---
layout:     post
date: Â  Â  Â  2018-04-12
author:     WWJ
header-img: img/post-bg-universe.jpg
catalog: true
tags: React
---

# Reactçš„é«˜é˜¶ç»„ä»¶ï¼ˆHOCï¼‰

### é«˜é˜¶å‡½æ•°

> æ¥å—ä¸€ä¸ªæˆ–è€…å¤šä¸ªå‡½æ•°ä½œä¸ºå‚æ•°
> è¿”å›ä¸€ä¸ªå‡½æ•°
> ä¸å¯¹ä¼ å…¥çš„å‡½æ•°åšä»»ä½•åŸå‹ä¸Šçš„ä¿®æ”¹

ä¸¾ä¸ªæ —å­ğŸŒ°
```javascript
localStorage.setItem('userName', 'wwj');

const welcome = () => {
	const userName = localStorage.getItem('userName');
	console.log('welcome ' + userName);
}

const goodby = () => {
	const userName = localStorage.getItem('userName');
	console.log('goodby ' + userName);
}

welcome();
userName();
```

ä¸Šé¢ä¸¤ä¸ªå‡½æ•°ä¸­æœ‰ä¸€éƒ¨åˆ†ä»£ç æ—¶å®Œå…¨ä¸€æ ·çš„ï¼Œ`const userName = localStorage.getItem('userName');`ï¼Œå³å¯ä»¥æŠŠç›¸åŒçš„ä»£ç æ‰”ç»™ä¸€ä¸ªä¸­é—´å‡½æ•°å»åš

```javascript
localStorage.setItem('userName', 'wwj');

const highOrderFunc = (wrapperFunc) => {
	const userName = localStorage.getItem('userName');
	// è¿”å›ä¸€ä¸ªåŒ¿åå‡½æ•°ç”¨æ¥å¤„ç†
	return function() {
		wrapperFunc(userName);
	}
}
function welcome(userName) {
	console.log('welcome ' + userName);
}

function goodby(userName) {
	console.log('goodby ' + userName);
}

welcome = highOrderFunc(welcome);
goodby = highOrderFunc(goodby);

welcome();
goodby();
```
ä¸Šé¢highOrderFuncå°±æ˜¯ä¸€ä¸ªé«˜é˜¶å‡½æ•°ï¼Œå®ƒå¤„ç†äº†userNameï¼Œå¹¶å°†userNameä¼ é€’ç»™äº†ç›®æ ‡å‡½æ•°ï¼Œå½“æˆ‘ä»¬è°ƒç”¨æœ€ç»ˆçš„welcome/goodbyå‡½æ•°çš„æ—¶å€™ï¼Œæ ¹æœ¬å°±ä¸éœ€è¦è€ƒè™‘userNameæ˜¯æ€ä¹ˆæ¥çš„


### é«˜é˜¶ç»„ä»¶

> æ¥å—ä¸€ä¸ªç»„ä»¶ä½œä¸ºå‚æ•°
> è¿”å›ä¸€ä¸ªæ–°çš„ç»„ä»¶
> ä¸å¯¹ä¼ å…¥çš„ç»„ä»¶è¿›è¡ŒåŸå‹ä¸Šçš„ä¿®æ”¹

æˆ‘ä»¬å°†ä¸Šé¢çš„ä¾‹å­æ”¹æˆç»„ä»¶çš„å½¢å¼
```javascript
import React from 'react';

export default function HighOrderComp(WrapperComp) {
	return class extends React.Component {
		constructor(props) {
			super(props);
			this.state = {
				userName: ''
			}
		}
		
		componentDidMount() {
			const userName = localStorage.getItem('userName');
			this.setState({ userName });
		}
		render() {
			const { userName } = this.state;
			return (
				<WrapperComp  userName={userName} />
			)
		}
		
	}
}

```
**é«˜é˜¶ç»„ä»¶å…¶å®æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªç»„ä»¶ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ªåŒ…è£¹ç›®æ ‡ç»„ä»¶çš„å®¹å™¨ç»„ä»¶**
<hr>
```javascript
import React from 'react';
import HighOrderComp from './HighOrderComp';

class Welcome extends React.Component {
	render() {
		return (
			<div> welcome { this.props.userName } </div>
		);
	}
}

Welcome = HighOrderComp(Welcome);
export default Welcome

```
<hr>
```javascript
import React from 'react';
import HighOrderComp from './HighOrderComp';

class Goodby extends React.Component {
	render() {
		return (
			<div> welcome { this.props.userName } </div>
		);
	}
}

Goodby = HighOrderComp(Goodby);
export default Goodby

```

é«˜é˜¶ç»„ä»¶å°±æ˜¯æŠŠuserNameé€šè¿‡propsä¼ é€’ç»™äº†ä¸åŒçš„ç›®æ ‡ç»„ä»¶ï¼Œè€Œç›®æ ‡ç»„ä»¶åªç®¡ä»propsæ‹¿userNameå°±å¥½äº†

react-reduxçš„connectå‡½æ•°å°±æ˜¯ä¸€ä¸ªé«˜é˜¶å‡½æ•°
æŠŠreduxçš„stateå’Œactionåˆ›å»ºå‡½æ•°ï¼Œé€šè¿‡propsæ³¨å…¥ç»™äº†Component
ä½ åœ¨ç›®æ ‡ç»„ä»¶Componenté‡Œé¢å¯ä»¥ç›´æ¥ç”¨this.propså»è°ƒç”¨redux stateå’Œactionåˆ›å»ºå‡½æ•°äº†
```javascript
ConnectedComment = connect(mapStateToProps, mapDispatchToProps)(Component);
```
